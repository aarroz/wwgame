[gd_scene load_steps=15 format=2]

[ext_resource path="res://assets/models/Tiles/prototype_materials/prop_prototype.material" type="Material" id=1]
[ext_resource path="res://assets/simple_fpsplayer/Player.tscn" type="PackedScene" id=2]
[ext_resource path="res://assets/models/Tiles/Light/texture_02.png" type="Texture" id=4]
[ext_resource path="res://assets/models/Tiles/Light/texture_10.png" type="Texture" id=5]

[sub_resource type="ProceduralSky" id=1]

[sub_resource type="Environment" id=2]
background_mode = 2
background_sky = SubResource( 1 )

[sub_resource type="GDScript" id=3]
script/source = "extends \"res://assets/scenes/puzzles/elements/puzzle_door_func.gd\"

func _on_button_for_firstdoor_body_entered(body):
	if body.is_in_group(\"Player\"):
		door_open()

func _on_button_for_firstdoor_body_exited(body):
	if body.is_in_group(\"Player\"):
		door_close()
"

[sub_resource type="SpatialMaterial" id=4]
albedo_texture = ExtResource( 4 )
uv1_triplanar = true

[sub_resource type="CubeMesh" id=5]
size = Vector3( 0.5, 6, 4 )

[sub_resource type="SpatialMaterial" id=6]
albedo_color = Color( 0.8, 0.8, 0.8, 1 )
albedo_texture = ExtResource( 5 )
uv1_scale = Vector3( 1.464, 1.5, 1 )
uv1_offset = Vector3( -0.23, 0.252, 0 )

[sub_resource type="BoxShape" id=7]
extents = Vector3( 0.5, 3, 2 )

[sub_resource type="Animation" id=8]
tracks/0/type = "bezier"
tracks/0/path = NodePath("door:translation:x")
tracks/0/interp = 1
tracks/0/loop_wrap = true
tracks/0/imported = false
tracks/0/enabled = true
tracks/0/keys = {
"points": PoolRealArray( 0, -0.25, 0, 0.25, 0, 0, -0.25, 0, 0.25, 0 ),
"times": PoolRealArray( 0, 1 )
}
tracks/1/type = "bezier"
tracks/1/path = NodePath("door:translation:y")
tracks/1/interp = 1
tracks/1/loop_wrap = true
tracks/1/imported = false
tracks/1/enabled = true
tracks/1/keys = {
"points": PoolRealArray( -1, -0.25, 0, 0.25, 0, -1, -0.25, 0, 0.25, 0 ),
"times": PoolRealArray( 0, 1 )
}
tracks/2/type = "bezier"
tracks/2/path = NodePath("door:translation:z")
tracks/2/interp = 1
tracks/2/loop_wrap = true
tracks/2/imported = false
tracks/2/enabled = true
tracks/2/keys = {
"points": PoolRealArray( -4, -0.25, 0, 0.25, 0, 0, -0.25, 0, 0.25, 0 ),
"times": PoolRealArray( 0, 1 )
}

[sub_resource type="Animation" id=9]
tracks/0/type = "bezier"
tracks/0/path = NodePath("door:translation:x")
tracks/0/interp = 1
tracks/0/loop_wrap = true
tracks/0/imported = false
tracks/0/enabled = true
tracks/0/keys = {
"points": PoolRealArray( 0, -0.25, 0, 0.25, 0, 0, -0.25, 0, 0.25, 0 ),
"times": PoolRealArray( 0, 1 )
}
tracks/1/type = "bezier"
tracks/1/path = NodePath("door:translation:y")
tracks/1/interp = 1
tracks/1/loop_wrap = true
tracks/1/imported = false
tracks/1/enabled = true
tracks/1/keys = {
"points": PoolRealArray( -1, -0.25, 0, 0.25, 0, -1, -0.25, 0, 0.25, 0 ),
"times": PoolRealArray( 0, 1 )
}
tracks/2/type = "bezier"
tracks/2/path = NodePath("door:translation:z")
tracks/2/interp = 1
tracks/2/loop_wrap = true
tracks/2/imported = false
tracks/2/enabled = true
tracks/2/keys = {
"points": PoolRealArray( 0, -0.25, 0, 0.25, 0, -4, -0.25, 0, 0.25, 0 ),
"times": PoolRealArray( 0, 1 )
}

[sub_resource type="CylinderShape" id=10]
radius = 1.5
height = 0.5

[node name="prototype_puzzle_elements" type="Spatial"]

[node name="Floor" type="CSGBox" parent="."]
use_collision = true
width = 100.0
height = 0.2
depth = 100.0
material = ExtResource( 1 )

[node name="WorldEnvironment" type="WorldEnvironment" parent="."]
environment = SubResource( 2 )

[node name="Player" parent="." instance=ExtResource( 2 )]
transform = Transform( -4.37114e-08, 0, -1, 0, 1, 0, 1, 0, -4.37114e-08, 0, 3, 10 )

[node name="door_and_button" type="Spatial" parent="."]
transform = Transform( 1, 0, 0, 0, 1, 0, 0, 0, 1, -30, 0, 0 )

[node name="Door1" type="Spatial" parent="door_and_button"]
transform = Transform( -4.37114e-08, 0, -1, 0, 1, 0, 1, 0, -4.37114e-08, 0, 4, -10 )
script = SubResource( 3 )

[node name="doorway" type="CSGCombiner" parent="door_and_button/Door1"]
material_override = SubResource( 4 )
use_in_baked_light = true
use_collision = true

[node name="CSGBox" type="CSGBox" parent="door_and_button/Door1/doorway"]
width = 1.0
height = 10.0
depth = 20.0

[node name="CSGBox2" type="CSGBox" parent="door_and_button/Door1/doorway"]
transform = Transform( 1, 0, 0, 0, 1, 0, 0, 0, 1, 0, -1.03178, 0 )
operation = 2
height = 6.0
depth = 4.0

[node name="door" type="StaticBody" parent="door_and_button/Door1"]
transform = Transform( 1, 0, 0, 0, 1, 0, 0, 0, 1, 0, -1, 0 )

[node name="MeshInstance" type="MeshInstance" parent="door_and_button/Door1/door"]
mesh = SubResource( 5 )
material/0 = SubResource( 6 )

[node name="CollisionShape" type="CollisionShape" parent="door_and_button/Door1/door"]
shape = SubResource( 7 )

[node name="AnimationPlayer" type="AnimationPlayer" parent="door_and_button/Door1"]
anims/door_close = SubResource( 8 )
anims/door_open = SubResource( 9 )

[node name="Button6" type="Spatial" parent="door_and_button"]
transform = Transform( 1, 0, 0, 0, 1, 0, 0, 0, 1, 0, 1, 0 )

[node name="CSGCombiner" type="CSGCombiner" parent="door_and_button/Button6"]
use_in_baked_light = true
use_collision = true

[node name="button" type="CSGCylinder" parent="door_and_button/Button6/CSGCombiner"]
transform = Transform( 1, 0, 0, 0, 1, 0, 0, 0, 1, 0, -0.668211, 0 )
height = 0.25
sides = 16

[node name="base" type="CSGCylinder" parent="door_and_button/Button6/CSGCombiner"]
transform = Transform( 1, 0, 0, 0, 1, 0, 0, 0, 1, 0, -1, 0 )
radius = 1.5
height = 0.5
sides = 16

[node name="button_for_firstdoor" type="Area" parent="door_and_button/Button6"]

[node name="CollisionShape" type="CollisionShape" parent="door_and_button/Button6/button_for_firstdoor"]
transform = Transform( 1, 0, 0, 0, 1, 0, 0, 0, 1, 0, -0.779329, 0 )
shape = SubResource( 10 )
[connection signal="body_entered" from="door_and_button/Button6/button_for_firstdoor" to="door_and_button/Door1" method="_on_button_for_firstdoor_body_entered"]
[connection signal="body_exited" from="door_and_button/Button6/button_for_firstdoor" to="door_and_button/Door1" method="_on_button_for_firstdoor_body_exited"]
